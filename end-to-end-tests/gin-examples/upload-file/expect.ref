--- a/multiple/main.go
+++ b/multiple/main.go
@@ -3,16 +3,31 @@
 import (
 	"net/http"
 	"path/filepath"
+	"time"
 
 	"github.com/gin-gonic/gin"
+	"github.com/newrelic/go-agent/v3/integrations/nrgin"
+	"github.com/newrelic/go-agent/v3/newrelic"
 )
 
 func main() {
+	NewRelicAgent, err := newrelic.NewApplication(newrelic.ConfigFromEnvironment())
+	if err != nil {
+		panic(err)
+	}
+
 	router := gin.Default()
+	router.Use(nrgin.Middleware(NewRelicAgent))
 	// Set a lower memory limit for multipart forms (default is 32 MiB)
 	router.MaxMultipartMemory = 8 << 20 // 8 MiB
 	router.Static("/", "./public")
+	// NR WARN: Since the handler function name is used as the transaction name,
+	// anonymous functions do not get usefully named.
+	// We encourage transforming anonymous functions into named functions
 	router.POST("/upload", func(c *gin.Context) {
+		nrTxn := nrgin.Transaction(c)
+
+		defer nrTxn.StartSegment("/upload").End()
 		name := c.PostForm("name")
 		email := c.PostForm("email")
 
@@ -35,4 +40,6 @@
 		c.String(http.StatusOK, "Uploaded successfully %d files with fields name=%s and email=%s.", len(files), name, email)
 	})
 	router.Run(":8080")
+
+	NewRelicAgent.Shutdown(5 * time.Second)
 }
--- a/single/main.go
+++ b/single/main.go
@@ -3,16 +3,28 @@
 import (
 	"net/http"
 	"path/filepath"
+	"time"
 
 	"github.com/gin-gonic/gin"
+	"github.com/newrelic/go-agent/v3/integrations/nrgin"
+	"github.com/newrelic/go-agent/v3/newrelic"
 )
 
 func main() {
+	NewRelicAgent, err := newrelic.NewApplication(newrelic.ConfigFromEnvironment())
+	if err != nil {
+		panic(err)
+	}
+
 	router := gin.Default()
+	router.Use(nrgin.Middleware(NewRelicAgent))
 	// Set a lower memory limit for multipart forms (default is 32 MiB)
 	router.MaxMultipartMemory = 8 << 20 // 8 MiB
 	router.Static("/", "./public")
 	router.POST("/upload", func(c *gin.Context) {
+		nrTxn := nrgin.Transaction(c)
+
+		defer nrTxn.StartSegment("/upload").End()
 		name := c.PostForm("name")
 		email := c.PostForm("email")
 
@@ -32,4 +34,6 @@
 		c.String(http.StatusOK, "File %s uploaded successfully with fields name=%s and email=%s.", file.Filename, name, email)
 	})
 	router.Run(":8080")
+
+	NewRelicAgent.Shutdown(5 * time.Second)
 }
